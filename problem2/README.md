# Посчёт количества cache miss для операции матричного умножения в зависимости от порядка итерирования

## Теоретические оценки

Для "IJK" и "JIK" алгоритма, число промахов кэша за шаг:
| A | B | C |
| ---- | --- | --- |
| 0.25 | 1.0 | 0.0 |

Итого 1.25 кэш-промахов, а такжк 2 операции чтения и 0 операций записи за 1 итерацию.

Для "IKJ" и "KIJ" алгоритма, число промахов кэша за шаг:
| A | B | C |
| --- | ---- | ---- |
| 0.0 | 0.25 | 0.25 |

Итого 0.5 кэш-промахов, а такжк 2 операции чтения и 1 операция записи за 1 итерацию.

Для "JKI" и "KJI алгоритма, число промахов кэша за шаг:
| A | B | C |
| --- | --- | --- |
| 1.0 | 0.0 | 1.0 |

Итого 2 кэш-промахов, а такжк 2 операции чтения и 1 операция записи за 1 итерацию.

## Практические результаты

Рассмотрены 6 вариантов матричного умножения, для разных типов данных - int32_t (4 байта для хранения одного элемента массива) и int64_t (8 байт соответственно).
Размер матриц - NROWS = 1000.
Соотвественно, для хранения матрицы (10^6) элементов, типа int32_t - нужно около 3.8Mb, а для хранения int64_t - около 7.6Mb соответственно.

Для матриц, использующих тип int32_t:

| type | L1 load | L1 Store | L1 cache | L2 load | L2 store | L2 cache | Theor | Theor/L1cache | Theor/L2cache |
| ---- | ---------- | ------- | ---------- | --------- | ------- | ----------| ---  | --- | --- |
| ijk | 1005498090 | 998393 | 1066085569 | 51712704 | 57585 | 159380465 | 0 | 0 | 0 |
| ikj | 36405026 | 609 | 62652563 | 2090336 | 290 | 128292300 | 0 | 0 | 0 |
| kij | 22612166 | 34 | 63833928 | 2421366 | 1 | 131852397 | 0 | 0 | 0 |
| jik | 1003400300 | 1000030 | 1058345997 | 7233689 | 1000004 | 173466008 | 0 | 0 | 0 |
| jki | 2244219270 | 405541 | 2245234804 | 395751610 | 10095 | 1257457115 | 0 | 0 | 0 |
| kji | 2243824571 | 458200 | 2247762525 | 402980634 | 8622 | 1250788158 | 0 | 0 | 0 |

Для матриц, использующих тип int64_t:

| type | L1 load | L1 Store | L1 cache | L2 load | L2 store | L2 cache | Theor | Theor/L1cache | Theor/L2cache |
| ---- | ---------- | ------- | ---------- | --------- | ------- | ----------| ---  | --- | --- |
| ijk | 1093759064 | 998830 | 1235444442 | 93129528 | 111277 | 257756758 | 0 | 0 | 0 |
| ikj | 5697647 | 1021 | 125935145 | 2107543 | 449 | 266962454 | 0 | 0 | 0 |
| kij | 6968536 | 46 | 127045177 | 3175781 | 50 | 283992431 | 0 | 0 | 0 |
| jik | 1077194915 | 1000006 | 1223101769 | 15903535 | 1000022 | 326634418 | 0 | 0 | 0 |
| jki | 2442295290 | 518937 | 2443572752 | 963309208 | 5587 | 2714769883 | 0 | 0 | 0 |
| kji | 2444286115 | 512585 | 2443850222 | 872013937 | 4197 | 2925320708 | 0 | 0 | 0 |
